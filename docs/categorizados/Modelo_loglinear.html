<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ANÁLISE DE DADOS CATEGORIZADOS STA13833</title>
    <meta charset="utf-8" />
    <meta name="author" content="Nátaly A. Jiménez Monroy" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# ANÁLISE DE DADOS CATEGORIZADOS STA13833
]
.subtitle[
## Modelos Loglineares
]
.author[
### Nátaly A. Jiménez Monroy
]
.institute[
### LECON/DEST - UFES
]
.date[
### Vitória. ES - 03/08/2022
]

---

class: animated, fadeIn




&lt;style&gt; body {text-align: justify} &lt;/style&gt; &lt;!-- Justify text. --&gt;



#Características

* Modelam os padrões de associação e de interação entre variáveis categóricas.

* São adequados para esquemas amostrais de Poisson, Multinomiais e Produto de Multinomiais.

* Apropriados para situações em que não há distinção clara entre resposta e variáveis explicativas ou quando há mais de uma resposta.

&gt;&lt;span style="color:orange"&gt;**Essa é a principal diferença entre os modelos logísticos e os loglineares**&lt;/span&gt;.

* Assumem que as variáveis discretas são nominais, mas é possível fazer ajustes para considerar ordinalidade e com dados pareados.

* São mais gerais que os modelos logit, mas alguns modelos loglineares têm correspondência direta com os modelos logit.


---
class: animated, fadeIn

#Modelos Loglineares para tabelas de duas vias - I

Sejam `\(\mu_{ij}\)` as contagens esperadas, `\(E(n_{ij})\)`, em uma tabela `\(I\times J\)` formada pelo cruzamento das variáveis `\(A\)` e `\(B\)`. O objetivo é modelar as contagens `\(\mu_{ij}=n\pi_{ij}\)`.


Sejam `\(N=I\times J\)`, as contagens das caselas, observações independentes de uma variável aleatória Poisson, `\(n_{ij}=Poisson(\mu_{ij})\)`. Um modelo loglinear análogo à ANOVA de duas vias com interação é dado por

`$$\log(\mu_{ij})=\lambda+\lambda_i^A+\lambda_j^B+\lambda_{ij}^{AB},$$`
onde `\(i=1,\ldots,I; j=1,\ldots,J\)` são os níveis das variáveis categóricas `\(A\)` e `\(B\)`. Com o objetivo de garantir a unicidade das estimativas, impõem-se as restrições `\(\sum_i \lambda_i=\sum_j \lambda_j=\sum_i\sum_j \lambda_{ij}=0\)`.


&gt;Esse modelo é superparametrizado porque o termo `\(\lambda_{ij}\)` já tem `\(I\times J\)` parâmetros correspondentes às médias das caselas `\(\mu_{ij}\)`. A constante `\(\lambda\)` e os efeitos principais `\(\lambda_i\)` e `\(\lambda_j\)` correspondem a `\(1+I+J\)` parâmetros adicionais. 

--

Nesse contexto, há dois tipos de modelos a serem considerados

 * Modelo de independência (A, B).
 * Modelo saturado (AB).
 
 
 
 
---
class: animated, fadeIn

##Modelo de Independência - I

A independência pode ser escrita em termos de probabilidades das caselas como o produto das probabilidades marginais

`$$\pi_{ij}=\pi_{i+}\pi_{+j}\quad i=1,\ldots,I, j=1,\ldots,J$$`
e em termos das frequências das caselas

`$$\mu_{ij}=n\pi_{ij}=n\pi_{i+}\pi_{+j}\quad i=1,\ldots,I, j=1,\ldots,J.$$`

Tomando logaritmos obtemos o modelo loglinear de independência

`$$\log(\mu_{ij})=\lambda + \lambda_i^A + \lambda_j^B,$$`
 onde `\(A\)` e `\(B\)` denotam as duas variáveis categóricas.
 
 
---
class: animated, fadeIn

##Modelo de Independência - II

 **Observações:**
 
  *  `\(\lambda\)` representa o efeito global, ou média geral dos logaritmos das contagens esperadas, garante que `\(\sum_i\sum_j \mu_{ij}=n\)`, isto é, as contagens esperadas sob o modelo ajustado totalizam o tamanho amostral `\(n\)`.
 
  * `\(\lambda_i^A\)` representa o efeito principal da variável A. Garante que `\(\sum_j \mu_{ij}=n_{i+}\)`, isto é, os totais marginais sob o modelo ajustado totalizam as contagens marginais observadas. Representa o efeito da classificação na linha `\(i\)`.
 
  * `\(\lambda_j^B\)` representa o efeito principal da variável B. Garante que `\(\sum_i \mu_{ij}=n_{+j}\)`. Representa o efeito da classificação na coluna `\(j\)`.
 
  * Restrições: `\(\lambda_I^A=\lambda_J^B=0\)`, ou alternativamente, `\(\sum_i \lambda_i^A=\sum_j \lambda_j^B=0\)`.
 
--

Os valores estimados por Máxima Verossimilhança para as contagens são os mesmos valores esperados sob o teste de independência em tabelas de duas vias, i.e., `\(E(\mu_{ij})=n_{i+}n_{+j}/n\)`. Portanto, as estatísticas `\(\chi^2\)` e `\(G^2\)` (deviance) para independência são testes de bondade do ajuste para o modelo loglinear de independência, onde as hipóteses são: o modelo de independência é o correto vs. o modelo saturado é o correto. Esse modelo também implica que todos os odds ratios são iguais a 1.
 

---
class: animated, fadeIn

##Modelo de Independência - III

Dependendo do tipo de restrição imposta, podemos obter diferentes estimativas dos parâmetros (i.e, diferentes valores dos `\(\lambda s\)`). Entretanto, as diferenças (log-odds) são únicos: `\(\lambda_i^A - \lambda_{i'}^A\)` e `\(\lambda_j^B - \lambda_{j'}^B\)`, onde o subíndice `\(i\)` denota um nível da variável categórica `\(A\)` e `\(i'\)` denota outro nível da mesma varíável; similarmente para `\(B\)`.

Dessa forma, os odds ratios também são únicos.

`$$\begin{align*}
   \log(odds)&amp;=\log\left(\frac{\mu_{i1}}{\mu_{i2}}\right)=\log(\mu_{i1})-\log(\mu_{i2})\\
   &amp;=(\lambda+\lambda_i^A+\lambda_1^B)-(\lambda+\lambda_i^A+\lambda_2^B)\\
   &amp;=(\lambda_1^B-\lambda_2^B)\\
   \end{align*}$$`
   
`$$\Longrightarrow odds=\exp(\lambda_1^B-\lambda_2^B)$$`


---
class: animated, fadeIn

##Modelo de Independência - IV


Sob o modelo de independência, espera-se que o log-odds seja 0, isto é, que o OR=1. Assim,

`$$\begin{align*}
\log(odds)&amp;=\log\left(\frac{\mu_{11}\mu_{22}}{\mu_{12}\mu_{21}}\right)\\
&amp;=\log(\mu_{11})+\log(\mu_{22})-\log(\mu_{12})-\log(\mu_{21})\\
&amp;=\lambda+\lambda_1^A+\lambda_1^B+\lambda+\lambda_2^A+\lambda_2^B-\lambda-\lambda_1^A-\lambda_2^B-\lambda-\lambda_2^A-\lambda_1^B\\
&amp;=0
\end{align*}$$`

--

&gt;**Observação:** 
O odds ratio mede a força da associação e depende apenas do termo de interação `\({\lambda_{ij}^{AB}}\)`, que claramente não aparece neste modelo.


---
class: animated, fadeIn

##Modelo Saturado

No modelo saturado as `\(N=I\times J\)` contagens nas caselas ainda são assumidas como observações independentes de uma variável aleatória Poisson, mas nãos e assume independência entre `\(A\)` e `\(B\)`. O modelo é representado como

`$$\log(\mu_{ij})=\lambda+\lambda_i^A+\lambda_j^B+\lambda_{ij}^{AB}.$$`
Nesse modelo também se aplicam as restrições semelhantes às da ANOVA para contornar a superparametrização.

**Estimativas dos parâmetros:**

O odds ratio está diretamente relacionado com o termo de interação. Por exemplo, para uma tabela `\(2\times 2\)`:

`$$\begin{align*}
\log(OR)&amp;=\log\left(\frac{\mu_{11}\mu_{22}}{\mu_{12}\mu_{21}}\right)\\
&amp;=\lambda+\lambda_1^A+\lambda_1^B+\lambda_{11}^{AB}+\lambda+\lambda_2^A+\lambda_2^B+\lambda_{22}^{AB}-\lambda-\lambda_1^A-\lambda_2^B-\lambda_{12}^{AB}-\lambda-\lambda_2^A-\lambda_1^B-\lambda_{21}^{AB}\\
&amp;=\lambda_{11}^{AB}+\lambda_{22}^{AB}-\lambda_{12}^{AB}-\lambda_{21}^{AB}.
\end{align*}$$`


---
class: animated, fadeIn

##Exemplo - I

Um estudo duplo-cego investigou o efeito terapeutico da vitamina C para tratar resfriados comuns. O estudo foi conduzido durante um período de duas semanas em uma amostra de 280 esquiadores franceses. Uma observação foi perdida por inconsistências. 


| Tratamento || Resfriado | Sem resfriado || Total |
|:----------:||----------:|:-------------:||:-----:|
|            ||           |               ||       |
| Placebo    ||    31     |      109      ||  140  |
| Vit. C     ||    17     |      122      ||  139  |
|  Total     ||    48     |      231      ||  279  |


```r
dados&lt;-matrix(c(31, 17, 109, 122), ncol=2, dimnames=list(Tratamento=c("Placebo", "VitC"), Resfriado=c("Com", "Sem")))
dados
```

```
##           Resfriado
## Tratamento Com Sem
##    Placebo  31 109
##    VitC     17 122
```

---
class: animated, fadeIn

##Exemplo - II


```r
library(vcd)
assocstats(dados)
```

```
##                     X^2 df P(&gt; X^2)
## Likelihood Ratio 4.8717  1 0.027301
## Pearson          4.8114  1 0.028272
## 
## Phi-Coefficient   : 0.131 
## Contingency Coeff.: 0.13 
## Cramer's V        : 0.131
```

---
class: animated, fadeIn

##Exemplo - III


```r
OR&lt;-oddsratio(dados, log=FALSE)
OR
```

```
##  odds ratios for Tratamento and Resfriado 
## 
## [1] 2.041015
```

```r
confint(OR)
```

```
##                         2.5 %  97.5 %
## Placebo:VitC/Com:Sem 1.070353 3.89193
```

&gt;A chance de pegar resfriado é aproximadamente o dobro para aqueles que tomaram o placebo, quando comparados com os que tomaram vitamina C.


---
class: animated, fadeIn

##Exemplo - IV

###Modelo de Independência


```r
dados&lt;-as.table(dados)
mod.indep&lt;-loglin(dados, list(1,2), fit=TRUE, param=TRUE)
```

```
## 2 iterations: deviation 0
```

```r
mod.indep[-3]#eliminando a impressão do terceiro item da lista (graus de liberdade)
```

```
## $lrt
## [1] 4.871697
## 
## $pearson
## [1] 4.811413
## 
## $margin
## $margin[[1]]
## [1] "Tratamento"
## 
## $margin[[2]]
## [1] "Resfriado"
## 
## 
## $fit
##           Resfriado
## Tratamento       Com       Sem
##    Placebo  24.08602 115.91398
##    VitC     23.91398 115.08602
## 
## $param
## $param$`(Intercept)`
## [1] 3.963656
## 
## $param$Tratamento
##      Placebo         VitC 
##  0.003584245 -0.003584245 
## 
## $param$Resfriado
##        Com        Sem 
## -0.7856083  0.7856083
```


---
class: animated, fadeIn

##Exemplo - V

**log-odds estimados:**

`$$\begin{align*}
\log(\mu_{11})&amp;=3.963656+0.003584245-0.7856083\\
\cdots\\
\log(\mu_{22})&amp;=3.963656-0.003584245+0.7856083\\
\end{align*}$$`

**odds de resfriado:**

`$$\begin{align*}
\exp(\lambda_1^R-\lambda_2^R)&amp;=\exp(-0.7856083-0.7856083)\\
&amp;=\exp(-1.5712)\\
&amp;=0.208
\end{align*}$$`


---
class: animated, fadeIn

##Exemplo - VI

###Modelo Saturado

```r
mod.sat&lt;-loglin(dados, list(c(1,2)), fit=TRUE, param=TRUE)
```

```
## 2 iterations: deviation 0
```

```r
mod.sat
```

```
## $lrt
## [1] 0
## 
## $pearson
## [1] 0
## 
## $df
## [1] 0
## 
## $margin
## $margin[[1]]
## [1] "Tratamento" "Resfriado" 
## 
## 
## $fit
##           Resfriado
## Tratamento Com Sem
##    Placebo  31 109
##    VitC     17 122
## 
## $param
## $param$`(Intercept)`
## [1] 3.940642
## 
## $param$Tratamento
##    Placebo       VitC 
##  0.1220252 -0.1220252 
## 
## $param$Resfriado
##        Com        Sem 
## -0.8070421  0.8070421 
## 
## $param$Tratamento.Resfriado
##           Resfriado
## Tratamento        Com        Sem
##    Placebo  0.1783618 -0.1783618
##    VitC    -0.1783618  0.1783618
```


---
class: animated, fadeIn

##Exemplo - VII

**Contagens esperadas sob o modelo ajustado**

```
##           Resfriado
## Tratamento Com Sem
##    Placebo  31 109
##    VitC     17 122
```

**Parâmetros estimados (efeitos principais)**

```
## $`(Intercept)`
## [1] 3.940642
## 
## $Tratamento
##    Placebo       VitC 
##  0.1220252 -0.1220252 
## 
## $Resfriado
##        Com        Sem 
## -0.8070421  0.8070421
```


---
class: animated, fadeIn

##Exemplo - VIII

**Parâmetros estimados (Interação)**

```
## $Tratamento.Resfriado
##           Resfriado
## Tratamento        Com        Sem
##    Placebo  0.1783618 -0.1783618
##    VitC    -0.1783618  0.1783618
```

&gt;Temos então:
`$$\begin{align*}
\log(\mu_{11})&amp;=3.940642+0.1220252-0.8070421+0.1783618\\
\cdots\\
\log(\mu_{22})&amp;=3.940642-0.1220252+0.8070421+0.1783618\\
\end{align*}$$`


---
class: animated, fadeIn

##Exemplo - IX

###Alternativa:


```r
dados1&lt;-as.data.frame(dados)
dados1
```

```
##   Tratamento Resfriado Freq
## 1    Placebo       Com   31
## 2       VitC       Com   17
## 3    Placebo       Sem  109
## 4       VitC       Sem  122
```

```r
modelo.ind&lt;-glm(dados1$Freq~dados1$Tratamento+dados1$Resfriado, family=poisson())
modelo.ind[1]
```

```
## $coefficients
##           (Intercept) dados1$TratamentoVitC   dados1$ResfriadoSem 
##           3.181631652          -0.007168489           1.571216700
```


---
class: animated, fadeIn

##Exemplo - X


```r
summary(modelo.ind)
```

```
## 
## Call:
## glm(formula = dados1$Freq ~ dados1$Tratamento + dados1$Resfriado, 
##     family = poisson())
## 
## Deviance Residuals: 
##       1        2        3        4  
##  1.3484  -1.4918  -0.6487   0.6382  
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)            3.181632   0.156179  20.372   &lt;2e-16 ***
## dados1$TratamentoVitC -0.007168   0.119738  -0.060    0.952    
## dados1$ResfriadoSem    1.571217   0.158626   9.905   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 135.4675  on 3  degrees of freedom
## Residual deviance:   4.8717  on 1  degrees of freedom
## AIC: 34.004
## 
## Number of Fisher Scoring iterations: 4
```

---
class: animated, fadeIn

##Exemplo - XI

###Modelo Saturado

```r
mod.sat&lt;-loglin(dados, list(c(1,2)), fit=TRUE, param=TRUE)
```

```
## 2 iterations: deviation 0
```

```r
mod.sat
```

```
## $lrt
## [1] 0
## 
## $pearson
## [1] 0
## 
## $df
## [1] 0
## 
## $margin
## $margin[[1]]
## [1] "Tratamento" "Resfriado" 
## 
## 
## $fit
##           Resfriado
## Tratamento Com Sem
##    Placebo  31 109
##    VitC     17 122
## 
## $param
## $param$`(Intercept)`
## [1] 3.940642
## 
## $param$Tratamento
##    Placebo       VitC 
##  0.1220252 -0.1220252 
## 
## $param$Resfriado
##        Com        Sem 
## -0.8070421  0.8070421 
## 
## $param$Tratamento.Resfriado
##           Resfriado
## Tratamento        Com        Sem
##    Placebo  0.1783618 -0.1783618
##    VitC    -0.1783618  0.1783618
```

---
class: animated, fadeIn

##Exemplo - XII

**Contagens esperadas sob o modelo ajustado**

```
##           Resfriado
## Tratamento Com Sem
##    Placebo  31 109
##    VitC     17 122
```

**Parâmetros estimados (efeitos principais)**

```
## $`(Intercept)`
## [1] 3.940642
## 
## $Tratamento
##    Placebo       VitC 
##  0.1220252 -0.1220252 
## 
## $Resfriado
##        Com        Sem 
## -0.8070421  0.8070421
```

---
class: animated, fadeIn

##Exemplo - XIII


```r
anova(modelo.ind)
```

```
## Analysis of Deviance Table
## 
## Model: poisson, link: log
## 
## Response: dados1$Freq
## 
## Terms added sequentially (first to last)
## 
## 
##                   Df Deviance Resid. Df Resid. Dev
## NULL                                  3    135.468
## dados1$Tratamento  1    0.004         2    135.464
## dados1$Resfriado   1  130.592         1      4.872
```

---
class: animated, fadeIn

##Exemplo - XIV


```r
modelo.sat&lt;-glm(dados1$Freq~dados1$Tratamento*dados1$Resfriado, family=poisson())
modelo.sat
```

```
## 
## Call:  glm(formula = dados1$Freq ~ dados1$Tratamento * dados1$Resfriado, 
##     family = poisson())
## 
## Coefficients:
##                               (Intercept)  
##                                    3.4340  
##                     dados1$TratamentoVitC  
##                                   -0.6008  
##                       dados1$ResfriadoSem  
##                                    1.2574  
## dados1$TratamentoVitC:dados1$ResfriadoSem  
##                                    0.7134  
## 
## Degrees of Freedom: 3 Total (i.e. Null);  0 Residual
## Null Deviance:	    135.5 
## Residual Deviance: 2.22e-16 	AIC: 31.13
```


---
class: animated, fadeIn

#Modelos Loglineares para tabelas de três vias

Seja `\(\mu_{ijk}\)` que representa a média dos níveis `\(i\)`, `\(j\)` e `\(k\)` das variáveis `\(A\)`, `\(B\)` e `\(C\)` respectivamente. O modelo é dado por 

`$$\log(\mu_{ijk})=\lambda+\lambda_i^A+\lambda_j^B+\lambda_k^C+\lambda_{ij}^{AB}+\lambda_{ik}^{AC}+\lambda_{jk}^{BC}+\lambda_{ijk}^{ABC}.$$`

--

Há diversos modelos que podem ser testados e ajustados, são eles:

* Saturado

* Independência completa

* Independência conjunta

* Independência condicional

* Associação Homogênea


---
class: animated, fadeIn

##Modelo Saturado - I

É o modelo default e serve para testar a bondade do ajuste dos outros modelos.

Sejam `\(N=I\times J\times K\)` as contagens nas caselas, assumidas como observações independentes de uma variável aleatória Poisson. O modelo é dado por 

`$$\log(\mu_{ijk})=\lambda+\lambda_i^A+\lambda_j^B+\lambda_k^C+\lambda_{ij}^{AB}+\lambda_{ik}^{AC}+\lambda_{jk}^{BC}+\lambda_{ijk}^{ABC}.$$`

Sujeito  a `\(\lambda_I^A=\lambda_J^B=\lambda_K^C=\lambda_{Ij}^{AB}=\cdots=\lambda_{ijK}^{ABC}=0.\)`

* `\(\lambda\)` representa o efeito global o grande média (na escala logarítmica) das contagens esperadas, garante que `\(\sum_i\sum_j\sum_k \mu_{ijk}=n.\)`

* `\(\lambda_i^{A}\)`, `\(\lambda_j^{B}\)` e `\(\lambda_k^{C}\)` representam os efeitos principais das variáveis `\(A\)`, `\(B\)` e `\(C\)`, ou desvios da média global.

* `\(\lambda_{ij}^{AB}\)`, `\(\lambda_{ik}^{AC}\)` e `\(\lambda_{jk}^{BC}\)` representam a interação/associação entre duas variáveis quando controlada a terceira (i.e., odds ratios condicionais, testes de associação parcial) e reflete o afastamento da independência.

* `\(\lambda_{ijk}^{ABC}\)` representa a associação/interação entre três variáveis e reflete o afastamento da independência.



---
class: animated, fadeIn

##Modelo Saturado - II

**Observações:**

 * Se há termo de interação significante, normalmente não olhamos para os termos de ordem inferior e apenas interpretamos os termos de ordem superior.
 
 * O modelo saturado tem ajuste perfeito, com `\(G^2=0\)` e 0 graus de liberdade, pois o número de caselas é igual ao número de parâmetros únicos no modelo.


---
class: animated, fadeIn

##Exemplo 2 - I

Lembremos das informações sobre admissões nas pós-graduações nos seis maiores departamentos da U.C. Berkeley em 1973.

 |  Departamento || Homens admitidos ||  Homens rejeitados  ||  Mulheres admitidas  ||  Mulheres rejeitadas  |
 |:-------------:||:----------------:||:-------------------:||:--------------------:||:---------------------:|
 |    A          ||     512          ||         313         ||      89              ||          19           |
 |    B          ||     353          ||         207         ||      17              ||          8            |
 |    C          ||     120          ||         205         ||      202             ||        391            |
 |    D          ||     139          ||         279         ||      131             ||        244            |
 |    E          ||      53          ||         138         ||       94             ||        299            |
 |    F          ||      22          ||         351         ||       24             ||        317            |


Denotemos por `\(D=\)` Departamento, `\(S=\)` Sexo e `\(A=\)` Admissão (admitido ou rejeitado). Seja `\(Y\)` a frequência observada em uma casela particular da tabela de três vias.  


---
class: animated, fadeIn

##Exemplo 2 - II


```r
UCBAdmissions
```

```
## , , Dept = A
## 
##           Gender
## Admit      Male Female
##   Admitted  512     89
##   Rejected  313     19
## 
## , , Dept = B
## 
##           Gender
## Admit      Male Female
##   Admitted  353     17
##   Rejected  207      8
## 
## , , Dept = C
## 
##           Gender
## Admit      Male Female
##   Admitted  120    202
##   Rejected  205    391
## 
## , , Dept = D
## 
##           Gender
## Admit      Male Female
##   Admitted  138    131
##   Rejected  279    244
## 
## , , Dept = E
## 
##           Gender
## Admit      Male Female
##   Admitted   53     94
##   Rejected  138    299
## 
## , , Dept = F
## 
##           Gender
## Admit      Male Female
##   Admitted   22     24
##   Rejected  351    317
```


---
class: animated, fadeIn

##Exemplo 2 - III


```r
berkeley&lt;-as.data.frame(UCBAdmissions)
berkeley$Gender = relevel(berkeley$Gender, ref='Female')
berkeley$Dept = relevel(berkeley$Dept, ref='F')
berkeley.sat = glm(Freq~Admit*Gender*Dept, family=poisson(), data=berkeley)
summary(berkeley.sat)
```

```
## 
## Call:
## glm(formula = Freq ~ Admit * Gender * Dept, family = poisson(), 
##     data = berkeley)
## 
## Deviance Residuals: 
##  [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
## 
## Coefficients:
##                                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                     3.17805    0.20412  15.569  &lt; 2e-16 ***
## AdmitRejected                   2.58085    0.21171  12.190  &lt; 2e-16 ***
## GenderMale                     -0.08701    0.29516  -0.295   0.7682    
## DeptA                           1.31058    0.23001   5.698 1.21e-08 ***
## DeptB                          -0.34484    0.31700  -1.088   0.2767    
## DeptC                           2.13021    0.21591   9.866  &lt; 2e-16 ***
## DeptD                           1.69714    0.22204   7.644 2.11e-14 ***
## DeptE                           1.36524    0.22870   5.969 2.38e-09 ***
## AdmitRejected:GenderMale        0.18890    0.30516   0.619   0.5359    
## AdmitRejected:DeptA            -4.12505    0.32968 -12.512  &lt; 2e-16 ***
## AdmitRejected:DeptB            -3.33462    0.47817  -6.974 3.09e-12 ***
## AdmitRejected:DeptC            -1.92041    0.22876  -8.395  &lt; 2e-16 ***
## AdmitRejected:DeptD            -1.95888    0.23781  -8.237  &lt; 2e-16 ***
## AdmitRejected:DeptE            -1.42370    0.24250  -5.871 4.33e-09 ***
## GenderMale:DeptA                1.83670    0.31672   5.799 6.66e-09 ***
## GenderMale:DeptB                3.12027    0.38572   8.090 5.99e-16 ***
## GenderMale:DeptC               -0.43376    0.31687  -1.369   0.1710    
## GenderMale:DeptD                0.13907    0.31938   0.435   0.6632    
## GenderMale:DeptE               -0.48599    0.34151  -1.423   0.1547    
## AdmitRejected:GenderMale:DeptA  0.86318    0.40267   2.144   0.0321 *  
## AdmitRejected:GenderMale:DeptB  0.03113    0.53349   0.058   0.9535    
## AdmitRejected:GenderMale:DeptC -0.31382    0.33741  -0.930   0.3523    
## AdmitRejected:GenderMale:DeptD -0.10691    0.34013  -0.314   0.7533    
## AdmitRejected:GenderMale:DeptE -0.38908    0.36500  -1.066   0.2864    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 2.6501e+03  on 23  degrees of freedom
## Residual deviance: 1.4788e-13  on  0  degrees of freedom
## AIC: 207.06
## 
## Number of Fisher Scoring iterations: 3
```


---
class: animated, fadeIn

##Exemplo 2 - IV

**Observações:**

* Os efeitos principais de `\(D\)`, `\(S\)` e `\(A\)` são difíceis de interpretar e não muito úteis, devido a que há associações de duas e três vias significantes

* Por exemplo, o coeficiente estimado da associação SA é `\(0.1889\)`. Dessa forma, o odds ratio estimado para o Departamento `\(F\)` (departamento de referência) é `\(\exp(0.1889)=1.208\)`. A categoria de referência para S é "Mulher" e para A é "admitido". A tabela S `\(\times\)` A no Departamento F, i.e., a tabela parcial é dada por

|  Dep. F  || Rejeitado  |  Admitido  |
|:--------:||:----------:|:----------:|
|  Homem   ||    351     |     22     |
|  Mulher  ||    317     |     24     |
 
De onde o odds ratio estimado é
 
 `$$OR=\frac{351\times 24}{317\times 22}=1.208.$$`


---
class: animated, fadeIn

##Exemplo 2 - V

* A estatística de Wald para o coeficiente SA é dada por
`$$z=0.1889/0.3052,$$`
que corresponde à estatística `\(\chi^2\)` `\((0.62^2=0.38)\)` com valor `\(p=0.5359\)` e indica que  o odds ratio SA para o departamento F não é significativamente diferente de 1 (log-odds ratio não é significativamente diferente de 0).

* Para obter o odds ratio SA para qualquer outro departamento, devemos combinar os coeficientes SA com um dos coeficientes DSA. Por exemplo, os odds ratio SA para o departamento A é
`$$\exp(0.1889+0.8632)=2.864.$$`

* A estatística `\(z\)` indica que o odds ratio SA para o departamento A é significativamente diferente do odds ratio SA no departamento F.

* O modelo saturado se torna mais complicado na medida em que o número de variáves aumenta.


---
class: animated, hide-logo, bounceInDown
## Política de proteção aos direitos autorais

&gt; &lt;span style="color:grey"&gt;O conteúdo disponível consiste em material protegido pela legislação brasileira, sendo certo que, por ser
o detentor dos direitos sobre o conteúdo disponível na plataforma, o **LECON** e o **NEAEST** detém direito
exclusivo de usar, fruir e dispor de sua obra, conforme Artigo 5&lt;sup&gt;o&lt;/sup&gt;, inciso XXVII, da Constituição Federal
e os Artigos 7&lt;sup&gt;o&lt;/sup&gt; e 28&lt;sup&gt;o&lt;/sup&gt;, da Lei 9.610/98.
A divulgação e/ou veiculação do conteúdo em sites diferentes à plataforma e sem a devida autorização do
**LECON** e o **NEAEST**, pode configurar violação de direito autoral, nos termos da Lei 9.610/98, inclusive podendo
caracterizar conduta criminosa, conforme Artigo 184&lt;sup&gt;o&lt;/sup&gt;, §1&lt;sup&gt;o&lt;/sup&gt; a 3&lt;sup&gt;o&lt;/sup&gt;, do Código Penal.
É considerada como contrafação a reprodução não autorizada, integral ou parcial, de todo e qualquer
conteúdo disponível na plataforma.&lt;/span&gt;

.pull-left[
&lt;img src="images/logo_lecon.png" width="50%" style="display: block; margin: auto;" /&gt;
]
.pull-right[
&lt;img src="images/logo_neaest.png" width="50%" style="display: block; margin: auto;" /&gt;
]
&lt;br&gt;&lt;/br&gt;
.center[
[https://lecon.ufes.br](https://lecon.ufes.br/) &amp;emsp; &amp;emsp;  &amp;emsp; &amp;emsp; [https://analytics.ufes.br](https://analytics.ufes.br)
]

&lt;font size="2"&gt;&lt;span style="color:grey"&gt;Material elaborado pela equipe LECON/NEAEST: 
Alessandro J. Q. Sarnaglia, Bartolomeu Zamprogno, Fabio A. Fajardo, Luciana G. de Godoi 
e Nátaly A. Jiménez.&lt;/span&gt;&lt;/font&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(images/logo_neaest.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  width: 150px;
  height: 168px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
