<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ANÁLISE DE DADOS CATEGORIZADOS STA13833</title>
    <meta charset="utf-8" />
    <meta name="author" content="Nátaly A. Jiménez Monroy" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# ANÁLISE DE DADOS CATEGORIZADOS STA13833
]
.subtitle[
## Modelos Loglineares
]
.author[
### Nátaly A. Jiménez Monroy
]
.institute[
### LECON/DEST - UFES
]
.date[
### Vitória. ES - 01/08/2022
]

---

class: animated, fadeIn




&lt;style&gt; body {text-align: justify} &lt;/style&gt; &lt;!-- Justify text. --&gt;



#Características

* Modelam os padrões de associação e de interação entre variáveis categóricas.

* São adequados para esquemas amostrais de Poisson, Multinomiais e Produto de Multinomiais.

* Apropriados para situações em que não há distinção clara entre resposta e variáveis explicativas ou quando há mais de uma resposta.

&gt;&lt;span style="color:orange"&gt;**Essa é a principal diferença entre os modelos logísticos e os loglineares**&lt;/span&gt;.

* Assumem que as variáveis discretas são nominais, mas é possível fazer ajustes para considerar ordinalidade e com dados pareados.

* São mais gerais que os modelos logit, mas alguns modelos loglineares têm correspondência direta com os modelos logit.


---
class: animated, fadeIn

##Modelo Loglineares para tabelas de duas vias - I

Sejam `\(\mu_{ij}\)` as contagens esperadas, `\(E(n_{ij})\)`, em uma tabela `\(I\times J\)` formada pelo cruzamento das variáveis `\(A\)` e `\(B\)`. O objetivo é modelar as contagens `\(\mu_{ij}=n\pi_{ij}\)`.


Sejam `\(N=I\times J\)`, as contagens das caselas, observações independentes de uma variável aleatória Poisson, `\(n_{ij}=Poisson(\mu_{ij})\)`. Um modelo loglinear análogo à ANOVA de duas vias com interação é dado por

`$$\log(\mu_{ij})=\lambda+\lambda_i^A+\lambda_j^B+\lambda_{ij}^{AB},$$`
onde `\(i=1,\ldots,I; j=1,\ldots,J\)` são os níveis das variáveis categóricas `\(A\)` e `\(B\)`. Com o objetivo de garantir a unicidade das estimativas, impõem-se as restrições `\(\sum_i \lambda_i=\sum_j \lambda_j=\sum_i\sum_j \lambda_{ij}=0\)`.


&gt;Esse modelo é superparametrizado porque o termo `\(\lambda_{ij}\)` já tem `\(I\times J\)` parâmetros correspondentes às médias das caselas `\(\mu_{ij}\)`. A constante `\(\lambda\)` e os efeitos principais `\(\lambda_i\)` e `\(\lambda_j\)` correspondem a `\(1+I+J\)` parâmetros adicionais. 

--

Nesse contexto, há dois tipos de modelos a serem considerados

 * Modelo de independência (A, B).
 * Modelo saturado (AB).
 
 
 
 
---
class: animated, fadeIn

##Modelo de Independência - I

A independência pode ser escrita em termos de probabilidades das caselas como o produto das probabilidades marginais

`$$\pi_{ij}=\pi_{i+}\pi_{+j}\quad i=1,\ldots,I, j=1,\ldots,J$$`
e em termos das frequências das caselas

`$$\mu_{ij}=n\pi_{ij}=n\pi_{i+}\pi_{+j}\quad i=1,\ldots,I, j=1,\ldots,J.$$`

Tomando logaritmos obtemos o modelo loglinear de independência

`$$\log(\mu_{ij})=\lambda + \lambda_i^A + \lambda_j^B,$$`
 onde `\(A\)` e `\(B\)` denotam as duas variáveis categóricas.
 
 
---
class: animated, fadeIn

##Modelo de Independência - II

 **Observações:**
 
  *  `\(\lambda\)` representa o efeito global, ou média geral dos logaritmos das contagens esperadas, garante que `\(\sum_i\sum_j \mu_{ij}=n\)`, isto é, as contagens esperadas sob o modelo ajustado totalizam o tamanho amostral `\(n\)`.
 
  * `\(\lambda_i^A\)` representa o efeito principal da variável A. Garante que `\(\sum_j \mu_{ij}=n_{i+}\)`, isto é, os totais marginais sob o modelo ajustado totalizam as contagens marginais observadas. Representa o efeito da classificação na linha `\(i\)`.
 
  * `\(\lambda_j^B\)` representa o efeito principal da variável B. Garante que `\(\sum_i \mu_{ij}=n_{+j}\)`. Representa o efeito da classificação na coluna `\(j\)`.
 
  * Restrições: `\(\lambda_I^A=\lambda_J^B=0\)`, ou alternativamente, `\(\sum_i \lambda_i^A=\sum_j \lambda_j^B=0\)`.
 
--

Os valores estimados por Máxima Verossimilhança para as contagens são os mesmos valores esperados sob o teste de independência em tabelas de duas vias, i.e., `\(E(\mu_{ij})=n_{i+}n_{+j}/n\)`. Portanto, as estatísticas `\(\chi^2\)` e `\(G^2\)` (deviance) para independência são testes de bondade do ajuste para o modelo loglinear de independência, onde as hipóteses são: o modelo de independência é o correto vs. o modelo saturado é o correto. Esse modelo também implica que todos os odds ratios são iguais a 1.
 

---
class: animated, fadeIn

##Modelo de Independência - III

Dependendo do tipo de restrição imposta, podemos obter diferentes estimativas dos parâmetros (i.e, diferentes valores dos `\(\lambda s\)`). Entretanto, as diferenças (log-odds) são únicos: `\(\lambda_i^A - \lambda_{i'}^A\)` e `\(\lambda_j^B - \lambda_{j'}^B\)`, onde o subíndice `\(i\)` denota um nível da variável categórica `\(A\)` e `\(i'\)` denota outro nível da mesma varíável; similarmente para `\(B\)`.

Dessa forma, os odds ratios também são únicos.

`$$\begin{align*}
   \log(odds)&amp;=\log\left(\frac{\mu_{i1}}{\mu_{i2}}\right)=\log(\mu_{i1})-\log(\mu_{i2})\\
   &amp;=(\lambda+\lambda_i^A+\lambda_1^B)-(\lambda+\lambda_i^A+\lambda_2^B)\\
   &amp;=(\lambda_1^B-\lambda_2^B)\\
   \end{align*}$$`
   
`$$\Longrightarrow odds=\exp(\lambda_1^B-\lambda_2^B)$$`


---
class: animated, fadeIn

##Modelo de Independência - IV


Sob o modelo de independência, espera-se que o log-odds seja 0, isto é, que o OR=1. Assim,

`$$\begin{align*}
\log(odds)&amp;=\log\left(\frac{\mu_{11}\mu_{22}}{\mu_{12}\mu_{21}}\right)\\
&amp;=\log(\mu_{11})+\log(\mu_{22})-\log(\mu_{12})-\log(\mu_{21})\\
&amp;=\cdots
\end{align*}$$`

--

&gt;**Observação:** 
O odds ratio mede a força da associação e depende apenas do termo de interação `\({\lambda_{ij}^{AB}}\)`, que claramente não aparece neste modelo.
---
class: animated, hide-logo, bounceInDown
## Política de proteção aos direitos autorais

&gt; &lt;span style="color:grey"&gt;O conteúdo disponível consiste em material protegido pela legislação brasileira, sendo certo que, por ser
o detentor dos direitos sobre o conteúdo disponível na plataforma, o **LECON** e o **NEAEST** detém direito
exclusivo de usar, fruir e dispor de sua obra, conforme Artigo 5&lt;sup&gt;o&lt;/sup&gt;, inciso XXVII, da Constituição Federal
e os Artigos 7&lt;sup&gt;o&lt;/sup&gt; e 28&lt;sup&gt;o&lt;/sup&gt;, da Lei 9.610/98.
A divulgação e/ou veiculação do conteúdo em sites diferentes à plataforma e sem a devida autorização do
**LECON** e o **NEAEST**, pode configurar violação de direito autoral, nos termos da Lei 9.610/98, inclusive podendo
caracterizar conduta criminosa, conforme Artigo 184&lt;sup&gt;o&lt;/sup&gt;, §1&lt;sup&gt;o&lt;/sup&gt; a 3&lt;sup&gt;o&lt;/sup&gt;, do Código Penal.
É considerada como contrafação a reprodução não autorizada, integral ou parcial, de todo e qualquer
conteúdo disponível na plataforma.&lt;/span&gt;

.pull-left[
&lt;img src="images/logo_lecon.png" width="50%" style="display: block; margin: auto;" /&gt;
]
.pull-right[
&lt;img src="images/logo_neaest.png" width="50%" style="display: block; margin: auto;" /&gt;
]
&lt;br&gt;&lt;/br&gt;
.center[
[https://lecon.ufes.br](https://lecon.ufes.br/) &amp;emsp; &amp;emsp;  &amp;emsp; &amp;emsp; [https://analytics.ufes.br](https://analytics.ufes.br)
]

&lt;font size="2"&gt;&lt;span style="color:grey"&gt;Material elaborado pela equipe LECON/NEAEST: 
Alessandro J. Q. Sarnaglia, Bartolomeu Zamprogno, Fabio A. Fajardo, Luciana G. de Godoi 
e Nátaly A. Jiménez.&lt;/span&gt;&lt;/font&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(images/logo_neaest.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  width: 150px;
  height: 168px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
